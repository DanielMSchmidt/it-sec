Index: git/libtelnet/encrypt.c
===================================================================
--- git.orig/libtelnet/encrypt.c	2011-12-25 16:51:52.000000000 +0100
+++ git/libtelnet/encrypt.c	2011-12-25 16:58:22.441175233 +0100
@@ -794,6 +794,9 @@
   int dir = kp->dir;
   register int ret = 0;
 
+   if (len > MAXKEYLEN)
+     len = MAXKEYLEN;
+
   if (!(ep = (*kp->getcrypt) (*kp->modep)))
     {
       if (len == 0)
